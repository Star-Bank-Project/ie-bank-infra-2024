{
    "version": "Notebook/1.0",
    "items": [
        {
            "type": 1,
            "content": {
                "json": "## StarBank Monitoring Strategy Overview\n\nThis workbook provides a comprehensive overview of our monitoring strategy for the StarBank web application, focusing on Service Level Agreements (SLAs), Service Level Objectives (SLOs), and Service Level Indicators (SLIs). \n\n- **SLA**: We guarantee 99.95% uptime and high performance, ensuring reliable service with minimal disruptions.\n- **SLO**: Targets include:\n  - 90% of API requests processed under 500ms.\n  - Page load times under 2 seconds.\n  - Error rates below 1%.\n- **SLI**: Actively monitor:\n  - API response time.\n  - Error rates.\n  - Uptime using Application Insights and Log Analytics Workspace.\n\nThis workbook ensures operational resilience and reliability for StarBank services."
            },
            "name": "text - Overview"
        },
        {
            "type": 3,
            "content": {
                "version": "KqlItem/1.0",
                "query": "requests\n| summarize Count = count(), FailedRequests = countif(success == false), SuccessPercentage = (countif(success == true) * 100.0 / count())\n| project Count, FailedRequests, SuccessPercentage",
                "size": 0,
                "timeContext": {
                    "durationMs": 86400000
                },
                "queryType": 0,
                "resourceType": "microsoft.insights/components",
                "visualization": "table"
            },
            "name": "query - Success Percentage"
        },
        {
            "type": 1,
            "content": {
                "json": "## API Response Time (SLO - 90% under 500ms)"
            },
            "name": "text - API Response Time"
        },
        {
            "type": 3,
            "content": {
                "version": "KqlItem/1.0",
                "query": "requests\n| where success == true\n| summarize AverageResponseTime = avg(duration), P90ResponseTime = percentile(duration, 90), P95ResponseTime = percentile(duration, 95)\n| extend SLOThreshold = 500\n| project AverageResponseTime, P90ResponseTime, P95ResponseTime, SLOThreshold",
                "size": 0,
                "timeContext": {
                    "durationMs": 86400000
                },
                "queryType": 0,
                "resourceType": "microsoft.insights/components",
                "visualization": "table"
            },
            "name": "query - API Response Time"
        },
        {
            "type": 1,
            "content": {
                "json": "## Page Load Times (SLO - Under 2 Seconds)"
            },
            "name": "text - Page Load Times"
        },
        {
            "type": 3,
            "content": {
                "version": "KqlItem/1.0",
                "query": "browserTimings\n| summarize AveragePageLoadTime = avg(totalDuration), P90PageLoadTime = percentile(totalDuration, 90), P95PageLoadTime = percentile(totalDuration, 95)\n| extend SLOThreshold = 2000\n| project AveragePageLoadTime, P90PageLoadTime, P95PageLoadTime, SLOThreshold",
                "size": 0,
                "timeContext": {
                    "durationMs": 86400000
                },
                "queryType": 0,
                "resourceType": "microsoft.insights/components",
                "visualization": "table"
            },
            "name": "query - Page Load Times"
        },
        {
            "type": 1,
            "content": {
                "json": "## Uptime Monitoring (SLA - Uptime > 99.95%)"
            },
            "name": "text - Uptime Monitoring"
        },
        {
            "type": 3,
            "content": {
                "version": "KqlItem/1.0",
                "query": "union requests, availabilityResults\n| summarize TotalRequests = count(), SuccessfulRequests = countif(success == true)\n| extend UptimePercentage = (SuccessfulRequests * 100.0) / TotalRequests\n| extend SLAThreshold = 99.95\n| project UptimePercentage, SLAThreshold",
                "size": 0,
                "timeContext": {
                    "durationMs": 86400000
                },
                "queryType": 0,
                "resourceType": "microsoft.insights/components",
                "visualization": "table"
            },
            "name": "query - Uptime Monitoring"
        },
        {
            "type": 1,
            "content": {
                "json": "## Error Rate Monitoring (SLI)"
            },
            "name": "text - Error Rate Monitoring"
        },
        {
            "type": 3,
            "content": {
                "version": "KqlItem/1.0",
                "query": "requests\n| summarize TotalRequests = count(), FailedRequests = countif(success == false)\n| extend ErrorRate = (todouble(FailedRequests) / todouble(TotalRequests)) * 100\n| project ErrorRate",
                "size": 0,
                "timeContext": {
                    "durationMs": 86400000
                },
                "queryType": 0,
                "resourceType": "microsoft.insights/components",
                "visualization": "table"
            },
            "name": "query - Error Rate Monitoring"
        }
    ],
    "fallbackResourceIds": [
        "/subscriptions/e0b9cada-61bc-4b5a-bd7a-52c606726b3b/resourceGroups/BCSAI2024-DEVOPS-STUDENTS-B-DEV/providers/Microsoft.Insights/components/makenna-appInsights-dev"
    ],
    "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
  }